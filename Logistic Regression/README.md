| ![](img/sysu.png) | äººå·¥æ™ºèƒ½å®éªŒ |
| ------------- | ------ |
|               |        |

##ä¸­å±±å¤§å­¦æ•°æ®ç§‘å­¦ä¸è®¡ç®—æœºå­¦é™¢ç§»åŠ¨ä¿¡æ¯å·¥ç¨‹ä¸“ä¸š

##äººå·¥æ™ºèƒ½æœ¬ç§‘ç”Ÿå®éªŒæŠ¥å‘Š

###ï¼ˆ2017-2018å­¦å¹´ç§‹å­£å­¦æœŸï¼‰
è¯¾ç¨‹åç§°ï¼š**Artificial Intelligence**

| æ•™å­¦ç­çº§ | **å‘¨äº”5-6** | ä¸“ä¸šï¼ˆæ–¹å‘ï¼‰ | ç§»åŠ¨äº’è”ç½‘ |
| ---- | --------- | ------ | ----- |
| å­¦å·   | 15352285  | å§“å     | ä»»ç£Šè¾¾   |

[TOC]

##ä¸€ã€ å®éªŒé¢˜ç›®

é€»è¾‘å›å½’


##äºŒã€ å®éªŒå†…å®¹

### ç®—æ³•åŸç†

é€»è¾‘æ–¯ç‰¹å›å½’æ˜¯ä¸€ç§å¯¹äºçº¿æ€§åˆ†ç±»å™¨ï¼ˆPLA)çš„ä¼˜åŒ–ï¼Œä½¿ç”¨Logisticå‡½æ•°å¯¹äºå‘é‡ç‚¹ä¹˜ç»“æœè¿›è¡Œæ±‚å’Œæ“ä½œå¾—åˆ°ä¸€ä¸ªæ¦‚ç‡å€¼ï¼Œè€Œåä»¥è¾ƒå¤§çš„æ¦‚ç‡å€¼è¿›è¡Œé¢„æµ‹ã€‚

#### ç®—æ³•æ­¥éª¤

1. åˆå§‹åŒ–æƒé‡ï¼Œå¯ä»¥ä½¿ç”¨åˆå§‹åŒ–ä¸º0æˆ–è€…åˆå§‹åŒ–ä¸ºéšæœºæ•°ã€‚
2. è®¡ç®—å½“å‰æƒé‡åœ¨è®­ç»ƒé›†ä¸Šé¢„æµ‹çš„è¯¯å·®ï¼Œè°ƒæ•´æƒé‡ã€‚
3. ä½¿ç”¨å¤šæ¬¡è¿­ä»£å¾—åˆ°çš„æƒé‡å¾—åˆ°æ¨¡å‹ï¼Œè€Œåé¢„æµ‹æµ‹è¯•é›†æ•°æ®ã€‚
   - å¦‚æœä½¿ç”¨baggingç­–ç•¥ï¼Œå¯ä»¥ä½¿ç”¨éªŒè¯æœºå¾—åˆ°çš„æœ€ä¼˜è§£è¿›è¡Œåˆ†ç±»ã€‚

#### åŸºæœ¬åŸç†

- æ¨¡å‹å‚æ•°**w** , è¾“å…¥ç‰¹å¾å‘é‡**x**, é•¿åº¦ä¸€æ ·ã€‚


- åˆæ­¥é¢„æµ‹å‚æ•°å’ŒPLAç±»ä¼¼ï¼š$s = W^Tx$
- ä½¿ç”¨`sigmoid` å‡½æ•°$h(x) = \frac{1}{1+e^{-x}}$è¿›è¡Œæ¦‚ç‡è½¬åŒ–$p=\frac{e^{W^Tx}}{1+e^{W^Tx}}$
  - é¢„æµ‹é˜¶æ®µç›´æ¥ä½¿ç”¨è¿™ä¸ªpå€¼è¿›è¡Œæ¯”è¾ƒé¢„æµ‹ã€‚

#### æ¢¯åº¦ä¸‹é™

ä½¿ç”¨ä¼¼ç„¶å‡½æ•°æ¯”è¾ƒé¢„æµ‹ç»“æœä¸çœŸå®ç»“æœä¹‹é—´çš„å…³è”åº¦
$$
likelihood(w)=\prod_{n=1}^{N}P(y_n|x_n,w)
\\ =\prod_{n=1}^{N}h(x_n)^{y_n}(1-h(x_n))^{1-y_n}
$$
å¯¹ç­‰å¼ä¸¤è¾¹å–è‡ªç„¶å¯¹æ•°ï¼Œå¾—åˆ°è¿›ä¸€æ­¥ç®€åŒ–åçš„å…¬å¼ï¼š
$$
L(w)=\sum_{n=1}^{N}y_nln(h(x_n))+(1-y_n)ln(1-h(x_n))
$$
ç›´è§‚çš„ï¼Œå½“L(w)è¶Šå¤§ï¼Œé¢„æµ‹ç»“æœä¸çœŸå®ç»“æœè¶Šç›¸å…³ï¼Œå®šä¹‰æŸå¤±å‡½æ•°C(w),ä¼˜åŒ–ç›®æ ‡ä¸ºï¼š
$$
{min}_{w} C(w)=min_w-L(w)\\=-\sum_{n=1}^{N}[y_nln(h(x_n))+(1-y_n)ln(1-h(x_n))]
\\ = \sum_{n=1}^{N}[y_nln(1+e^{-W^Tx})+(1-y_n)ln(1+e^{W^Tx})]
$$
è€Œä¼˜åŒ–è¿™æ ·çš„å‡¸å‡½æ•°ï¼Œä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•å®ç°ï¼Œæ¯ä¸€ä¸ªwçš„ä½ç½®å‡å»å¯¹åº”ä½ç½®çš„æ¢¯åº¦ï¼ˆåå¯¼æ•°ï¼‰
$$
w_{j,.i+1}=w_{j,i}-\frac{\partial C(w)}{\partial w_j}
\\=w_{j,i}-\sum_{n=1}^{N}[y_n*(-x_{n,j})*e^{-W^Tx_n}*\frac{1}{1+e^{-W^Tx_n}}+(1-y_n)*(x_j)*e^{W^Tx_n}\frac{1}{1+e^{W^Tx_n}}]
\\=w_{j,i}-\sum_{n=1}^{N}\frac{1}{1+e^{-W^Tx_n}}*(y_n*(-x_{n,j})*e^{-W^Tx_n}+(1-y_n)*(x_{n,j}))
\\=w_{j,i}-\sum_{n=1}^{N}\frac{x_{n,j}}{1+e^{-W^Tx_n}}(1-y_n(e^{-W^Tx_n}+1))
\\=w_{j,i}-\sum_{n=1}^{N}x_{n,j}*(\frac{1}{1+e^{-W^Tx_n}}-y_n)
$$
å½“è€ƒè™‘æ¢¯åº¦ä¸‹é™çš„æ­¥é•¿æ—¶å€™ï¼Œå¯ä»¥åœ¨åå¯¼å‰é¢åŠ ä¸€ä¸ªå‚æ•°æ§åˆ¶æ­¥é•¿
$$
w_{j,.i+1}=w_{j,i}-\eta \frac{\partial C(w)}{\partial w_j}
\\=w_{j,i}-\eta\sum_{n=1}^{N}[y_n*(-x_{n,j})*e^{-W^Tx_n}*\frac{1}{1+e^{-W^Tx_n}}+(1-y_n)*(x_j)*e^{W^Tx_n}\frac{1}{1+e^{W^Tx_n}}]
\\=w_{j,i}-\eta\sum_{n=1}^{N}\frac{1}{1+e^{-W^Tx_n}}*(y_n*(-x_{n,j})*e^{-W^Tx_n}+(1-y_n)*(x_{n,j}))
\\=w_{j,i}-\eta\sum_{n=1}^{N}\frac{x_{n,j}}{1+e^{-W^Tx_n}}(1-y_n(e^{-W^Tx_n}+1))
\\=w_{j,i}-\eta\sum_{n=1}^{N}x_{n,j}*(\frac{1}{1+e^{-W^Tx_n}}-y_n)
$$

#### L2æ­£åˆ™åŒ–

åœ¨è¯¥æ¨¡å‹å½“ä¸­ï¼Œå¦‚æœä¸€ä¸ª$w_j$çš„ç»å¯¹å€¼è¿‡å¤§ï¼Œå¯ä»¥è®¤ä¸ºè¯•å›¾æ¨¡æ‹Ÿé«˜é˜¶å‡½æ•°ï¼Œå¢å¤§æ¨¡å‹å¤æ‚åº¦ã€‚è€Œè¿‡é«˜çš„æ¨¡å‹å¤æ‚åº¦å®¹æ˜“å½¢æˆè¿‡æ‹Ÿåˆçš„æ¨¡å‹ï¼Œäºæ˜¯åœ¨åŸæœ‰æ¨¡å‹ä¸Šé¢åŠ ä¸Šä¸€ä¸ªL2æ­£åˆ™åŒ–ä»¥å¢åŠ åœ¨éªŒè¯é›†ä»¥åŠæµ‹è¯•é›†ä¸Šé¢çš„å‡†ç¡®åº¦ï¼š

è¿™æ—¶å€™æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š
$$
C'(w)=C(w)+\lambda\sum_{j=1}^{n}w_j^2
$$
è€Œè¿™æ—¶å€™æ¢¯åº¦ä¸‹é™ä¸­çš„åå¯¼å˜ä¸º
$$
\frac{\partial (\eta C(w)+\lambda \sum_{j=1}^nw_j^2)}{\partial w_j}
=\frac{\eta \partial C(w)}{\partial w_j}+\frac{\lambda \sum_{j=1}^nw_j^2}{\partial w_j}

\\=\eta\sum_{n=1}^{N}x_{n,j}*(\frac{1}{1+e^{-W^Tx_n}}-y_n)+2\lambda w_j
$$

### ä¼ªä»£ç 

```python
Variable:
    fLen	: frature/weight len
    x 		: train frature set
    y 		: train label set   
    test	: test feature
    w 		: feature of model
    delta	: change item
    cost 	: predict part

w <- zeros(0, fLen)

# train
# while not convergence
for iter in range(ITER_NUM):
    delta <- zeros(0,fLen)
    for i in range(data_len):
        cost <- 1.0 / (1 + exp(-W.*x[i]))
        for j in range(fLen):
            delta[j] <- x[i][j] * delta[j] - y[i] 
    for j in range(fLen):
    	w[j] <- w[j] - delta[j]
        
# predict
sum = 0
for i in range(fLen):
    sum <- sum + w[i] * test[i]

1 if sum > 0.5, else 0
```





### **å…³é”®**ä»£ç æˆªå›¾

#### è®­ç»ƒä»£ç 

```c++
void LogisticRegression::train(int OptimizerFlag)
{
    if(oriReadFlag == false) ReadOriginalData();
    if(testReadFlag== false) ReadTestData();
    if(genFlag == false)     GenTrain_Valid();
    
    //æ ‡å‡†åŒ–
    if(OptimizerFlag & (1 << Standalize)) StandalizeData();
    
    initZeroWeight(w);       // åˆå§‹åŒ–æ–¹å¼
    double alpha = 0.00001; // å­¦ä¹ ç‡
    double theta = bool(OptimizerFlag & (1 << Normalize))? 1e-4 : 0;        // æ­£åˆ™åŒ–é¡¹ç³»æ•°
    double u = 0.9, v = 0.999, m = 0, n = 0, m_ = 0, n_ = 0, ep = 1e-8; // adamç³»æ•°
    dr << "iteration,Accuracy,Precision,Recall,F1,loss" << endl;
    for (int iter = 1; iter <= 100; ++iter) {
        initZeroWeight(delta);
        // Normalizer
        double loss_normal= 0;
        if(OptimizerFlag & (1 << Normalize))
            for(int wi = 0; wi < w.size(); ++wi)
            {
                loss_normal += theta * w[wi] * w[wi];
            }
        double loss = loss_normal;
        // åˆ†ä¸¤æ­¥ä¸ºæ™®é€šæ¢¯åº¦ä¸‹é™ï¼Œä¸€ä¸ªforä¸ºSGD
        for(int F = 0; F < trainData.size(); ++F)
        {
            double wtxi = 0;
            for (int idx = 0; idx < oridata[0].first.size(); ++idx) {
                wtxi += w[idx] * trainData[F].first[idx];
            }
            double hxi = 1.0 / (1 + exp(-wtxi));
            if(hxi < 1 && hxi > 0)
            loss -= trainData[F].second * log(hxi) + (1 - trainData[F].second) * log(1-hxi);
            if(OptimizerFlag & (1 << SGD))
            {
                // éšæœºæ¢¯åº¦ä¸‹é™
                for (int idx = 0; idx < oridata[0].first.size(); ++idx) {
                    w[idx] -= alpha * (exp(wtxi)/ (1 + exp(wtxi)) - trainData[F].second) * trainData[F].first[idx];
                }
            }
            else
            {
                for (int idx = 0; idx < oridata[0].first.size(); ++idx) {
                    delta[idx] += (exp(wtxi)/ (1 + exp(wtxi)) - trainData[F].second) * trainData[F].first[idx];
                }
            }
        }
        if((OptimizerFlag & (1 << SGD)) == 0)
        {
            if(OptimizerFlag & (1 << DynamicLearnRate))
            {
              // adam æ–¹æ³•è°ƒæ•´ä¼˜åŒ–ç‡
                m = u * m + (1 - u) * loss;
                n = v * n + (1 - v) * loss * loss;
                m_ = m / (1 - pow(u, iter));
                n_ = n / (1 - pow(v, iter));
                double delta_ = (m_ / (sqrt(n_) + ep)) * alpha;
                cerr << delta_ << endl;
                for (int idx = 0; idx < oridata[0].first.size(); ++idx) {
                    w[idx] -= delta_ * delta[idx] - 2 * theta * w[idx];
                }
            }
            else{
                for (int idx = 0; idx < oridata[0].first.size(); ++idx) {
                    w[idx] -= alpha * delta[idx] - 2 * theta * w[idx];
                }
            }
        }
        
        dr << iter << ",";
        cerr << "ITER " << iter << ": (" ;
        for(int i = 0; i < w.size(); ++i) cerr << w[i] << ","; cerr <<")";
        double Accuracy = validate();
        dr << loss << endl;
        // bagging
        if((OptimizerFlag&(1<<Bagging)) && Accuracy > bestAccu)
        {
            bestAccu = Accuracy;
            bestw = w;
        }
    }
}
```

#### åˆ’åˆ†æµ‹è¯•é›†

ä½¿ç”¨5ï¼š1çš„é»˜è®¤æ¦‚ç‡æ¯”ä¾‹åˆ’åˆ†æ•°æ®é›†

```c++
void LogisticRegression::GenTrain_Valid(double alpha)
{
    // new dataset.
    trainData.clear();
    validData.clear();
    // 20% percent to valid
    for(int dat = 0; dat < (int)oridata.size(); ++dat)
    {
        if(rand()*1.0/RAND_MAX < alpha)
        {
            validData.push_back(oridata[dat]);
        }
        else
        {
            trainData.push_back(oridata[dat]);
        }
    }
    cout << "Divide train(" << trainData.size() << "), valid(" << validData.size() << ")\n";
}
```



### åˆ›æ–°ç‚¹&ä¼˜åŒ–

- éšæœºæ¢¯åº¦ä¸‹é™
  - åŸå§‹æ¢¯åº¦ä¸‹é™æ–¹æ³•ä¸­é—´æ˜¯è®¡ç®—**æ‰€æœ‰æ ·æœ¬**çš„æŸå¤±å‡½æ•°å¯¹äºå•ä¸ªwç³»æ•°çš„åå¯¼ï¼Œè¿™æ ·æŸå¤±äº†å•ä¸ªæ ·æœ¬çš„ç‰¹æ€§ï¼Œè€Œåœ¨éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•å½“ä¸­ï¼Œä½¿ç”¨**å•ä¸ªæ ·æœ¬**å¯¹äºwè¿›è¡Œæ›´æ–°ï¼Œç”¨æ›´å°çš„æ­¥é•¿æ¥å®ç°wçš„æ›´æ–°ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ä¼˜åŒ–äº†å¯¹äºæœ€ä¼˜æŒ‡çš„é€¼è¿‘ã€‚
  - è¿›ä¸€æ­¥è€Œè¨€å¯ä»¥é‡‡ç”¨æ›´åŠ é€šç”¨åŒ–çš„mini-batchæ¢¯åº¦ä¸‹é™ï¼Œä½¿ç”¨éƒ¨åˆ†æ ·æœ¬æ¥æ›´æ–°wï¼Œè¿™æ ·å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šç¼“å’Œå•ä¸ªæ ·æœ¬å¯¹çš„è¯¯å·®ã€‚
- æ ‡å‡†åŒ–
  - ç”±äºç‰¹å¾ä¸Šçš„æ¯ä¸€åˆ—å•ä½å¯èƒ½ä¸åŒï¼Œä½¿ç”¨é™¤ä»¥æ ‡å‡†å·®æ¥æ¶ˆå»å•ä½ï¼Œäºæ˜¯æ–¹æ³•æ˜¯è®¡ç®—æ¯ä¸€åˆ—çš„æ ‡å‡†å·®ï¼Œè€Œåæ ‡å‡†åŒ–æ¯ä¸€ä¸ªå…ƒç´ ã€‚
- æ­£åˆ™åŒ–
  - å½“æ¨¡å‹å¤æ‚åº¦é«˜çš„æ—¶å€™ï¼Œå¯ä»¥å¾ˆå¥½çš„æ‹Ÿåˆè®­ç»ƒé›†ä¸Šçš„æ•°æ®çš„åŒæ—¶æ³›åŒ–èƒ½åŠ›å·®ã€‚
  - è¿™æ—¶å€™åŠ å…¥ä¸€ä¸ªæ­£åˆ™é¡¹æ¥æƒ©ç½šæ¨¡å‹å¤æ‚åº¦ï¼Œæé«˜æ³›åŒ–èƒ½åŠ›ã€‚
- åŠ¨æ€å­¦ä¹ ç‡è°ƒæ•´
  - åœ¨æœ¬æ¬¡å®éªŒä¸­ä½¿ç”¨[Adam](https://arxiv.org/abs/1412.6980)æ–¹æ³•è¿›è¡ŒåŠ¨æ€å­¦ä¹ ç‡è°ƒæ•´ï¼Œç®€è€Œè¨€ä¹‹è¯¥æ–¹æ³•å­˜å‚¨äº†å‰ä¸¤æ¬¡æ¢¯åº¦çš„ä¸€æ¬¡å’ŒäºŒæ¬¡é¡¹ï¼Œä»è€Œä¾æ¬¡æ¥ç¼“å†²æ¢¯åº¦å¿½ç„¶å˜åŒ–å¸¦æ¥çš„å½±å“ï¼Œä»è€Œè°ƒæ•´åŠ¨æ€å­¦ä¹ ç‡ã€‚
- bagging
  - ä½¿ç”¨åœ¨éªŒè¯é›†ä¸Šï¼Œå¤šæ¬¡è¿­ä»£ä¸­ï¼Œè¡¨ç°æœ€ä¼˜çš„æ¨¡å‹è¿›è¡Œæµ‹è¯•é›†çš„éªŒè¯ã€‚
- éšæœºåˆå§‹åŒ–
  - ç”±äºæ¢¯åº¦ä¸‹é™æ³•å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜è§£ï¼Œé€šè¿‡éšæœºåˆå§‹åŒ–å¤šä¸ªåˆå§‹å‚æ•°ï¼Œå¯ä»¥å°è¯•æ‰¾åˆ°å¤šä¸ªå±€éƒ¨æœ€ä¼˜è§£ï¼Œå¯çŸ¥å½“åˆå§‹åŒ–å‚æ•°ä¸ªæ•°è¶³å¤Ÿå¤šçš„æ—¶å€™ï¼Œä¼šæ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜ã€‚


##ä¸‰ã€ å®éªŒç»“æœåŠåˆ†æ

###å®éªŒç»“æœå±•ç¤ºç¤ºä¾‹
> å°æ•°æ®æµ‹è¯•

#### æ•°æ®é›†

ä½¿ç”¨å®éªŒæ–‡æ¡£æ•°æ®é›†ï¼Œ**é›¶åˆå§‹åŒ–**

| No     | Attribute1 | Attribute2 | label |
| ------ | ---------- | ---------- | ----- |
| train1 | 1          | 2          | 1     |
| train2 | 2          | -1         | 0     |
| test1  | 3          | 3          | ?     |

åˆå§‹åŒ–**w**ä¸º`[0,0,0]`

#### è®­ç»ƒ

1. ç”±äºæ˜¯é›¶åˆå§‹åŒ–ï¼Œæ¯ä¸ªæ ·æœ¬æƒé‡åˆ†æ•°ä¸º0,æ¯ä¸ªå‚æ•°æ·»åŠ ä¸€ä¸ªbias attribute `1`

2. æ¯ä¸€ç»´çš„æ¢¯åº¦è®¡ç®—ï¼š
   $$
   ğ›Cost(W_{0,0})=(\frac{1}{1+e^0}-1)*1+(\frac{1}{1+e^0}-0)*1=0.5
   \\
   ğ›Cost(W_{0,1})=(\frac{1}{1+e^0}-1)*1+(\frac{1}{1+e^0}-0)*2=1
   \\
   ğ›Cost(W_{0,2})=(\frac{1}{1+e^0}-1)*2+(\frac{1}{1+e^0}-0)*(-1)=-0.5
   $$


3. æ›´æ–°æ¢¯åº¦ï¼š
   $$
   W_{1,0}=W_{0,0} -ğ›Cost(W_{0,0})=-0.5
   \\
   W_{1,1}=W_{0,1} -ğ›Cost(W_{0,1})=1
   \\
   W_{1,2}=W_{0,2} -ğ›Cost(W_{0,2})=0.5
   $$


4. æµ‹è¯•
   $$
   W^Tx=-0.5*1+1*3+0.5*3=4
   \\
   \frac{1}{1+e^{-4}}=0.982>0.5
   $$
   åˆ¤å®šä¸º1

###è¯„æµ‹æŒ‡æ ‡å±•ç¤ºå³åˆ†æ
> åŸºç¡€æŒ‡æ ‡&ä¼˜åŒ–æŒ‡æ ‡

#### å¯¹äºå››ä¸ªæŒ‡æ ‡ä¼˜åŒ–æ•ˆæœ

| ä¼˜åŒ–ç±»å‹        | å­¦ä¹ ç‡=1e-4          | å­¦ä¹ ç‡=1e-5          | å­¦ä¹ ç‡=1e-6          |
| ----------- | ----------------- | ----------------- | ----------------- |
| æ— ä¼˜åŒ–         | ![](img/naivee-3.png) | ![](img/naivee-4.png) | ![](img/naivee-5.png) |
| SGDï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰ | ![](img/sgde-3.png)   | ![](img/sgde-4.png)   | ![](img/sgde-5.png)   |
| æ ‡å‡†åŒ–         | ![](img/stde-3.png)   | ![](img/stde-4.png)   | ![](img/stde-5.png)   |
| SGD+æ ‡å‡†åŒ–     | ![](img/sse-4.png)    | ![](img/sse-5.png)    | ![](img/sse-6.png)    |
| æ­£åˆ™åŒ–         | ![](img/nore-3.png)   | ![](img/nore-4.png)   | ![](img/nore-5.png)   |
| adamåŠ¨æ€å­¦ä¹ ç‡   | ![](img/adam-3.png)   | ![](img/adam-4.png)   | ![](img/adam-5.png)   |

å¯ä»¥çœ‹åˆ°éšæœºæ¢¯åº¦ä¸‹é™å¯¹äºæ¨¡å‹çš„ç¨³å®šæ€§æœ‰æ˜¾è‘—çš„ä¼˜åŒ–ï¼ŒåŒæ—¶å­¦ä¹ ç‡è¿‡å¤§ä¸ä¼šæ”¶æ•›ï¼Œå­¦ä¹ ç‡è¿‡å°ä¸å®¹æ˜“æ”¶æ•›ã€‚

#### æ­£åˆ™åŒ–é¡¹ä¼˜åŒ–

è¿™é‡Œæ¯”è¾ƒäº†ä¸¤ç§L2æ­£åˆ™åŒ–ç³»æ•°å¯¹äºæ¨¡å‹æŸå¤±å‡½æ•°å€¼å½±å“ï¼š

![](img/vs1e-4-5.png)

å¯ä»¥çœ‹åˆ°åœ¨æ”¶æ•›é€Ÿåº¦ä¸Šæœ‰æ˜æ˜¾çš„å·®è·ã€‚

##å››ã€ æ€è€ƒé¢˜

1. å¦‚æœæŠŠ æ¢¯åº¦ä¸º 0 ä½œä¸ºç®—æ³•åœæ­¢çš„æ¡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æ€æ ·çš„å¼Šç«¯ï¼Ÿ

   1. å¯èƒ½ç”±äºå­¦ä¹ ç‡æ¨¡å‹ä¸ä¼šæ”¶æ•›åˆ°æ¢¯åº¦ä¸º0çš„ä½ç½®ã€‚
   2. é™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚

2. ğœ‚ çš„å¤§å°ä¼šæ€ä¹ˆå½±å“æ¢¯åº¦ä¸‹é™çš„ç»“æœï¼Ÿ ç»™å‡ºå…·ä½“çš„è§£é‡Šï¼Œå¯è§†åŒ–çš„è§£é‡Šæœ€å¥½ï¼Œæ¯”å¦‚å›¾å½¢å±•ç¤ºç­‰

   1. å¦‚å®éªŒç»“æœå±•ç¤ºï¼Œğœ‚ åå¤§ä¼šéš¾ä»¥æ”¶æ•›ï¼Œåå°æ”¶æ•›é€Ÿåº¦æ…¢ã€‚

3. æ€è€ƒè¿™ä¸¤ç§ä¼˜åŒ–æ–¹æ³•ï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼Œæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰çš„ä¼˜ç¼ºç‚¹

   1. éšæœºæ¢¯åº¦ä¸‹é™å¯ä»¥åŠ é€Ÿæ”¶æ•›é€Ÿåº¦ï¼Œä½†æ˜¯å¯èƒ½ä¸ä¼šä¸€ç›´å¾€â€œæ­£ç¡®çš„â€æ–¹å‘ç§»åŠ¨ï¼Œè€Œæ˜¯é€šè¿‡å¤§é‡æ ·æœ¬å¼¥è¡¥å•ä¸ªæ ·æœ¬å¸¦æ¥çš„è¯¯å·®
   2. æ‰¹é‡æ¢¯åº¦ä¸‹é™å¯ä»¥å®ç°å¹¶è¡Œå®ç°ï¼Œä½†è®­ç»ƒé€Ÿåº¦æ…¢ã€‚

   - btwï¼Œå¯ä»¥ä½¿ç”¨mini-batchä¸‹é™ç»¼åˆä¸¤è€…ä¼˜ç‚¹å®¹é‡å¤§09ã€‚



